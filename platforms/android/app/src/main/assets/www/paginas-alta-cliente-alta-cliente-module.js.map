{"version":3,"sources":["webpack:///./src/app/paginas/alta-cliente/alta-cliente.module.ts","webpack:///./src/app/paginas/alta-cliente/alta-cliente.page.html","webpack:///./src/app/paginas/alta-cliente/alta-cliente.page.scss","webpack:///./src/app/paginas/alta-cliente/alta-cliente.page.ts","webpack:///./src/app/servicios/firestorage.service.ts"],"names":[],"mappings":"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","file":"paginas-alta-cliente-alta-cliente-module.js","sourcesContent":["import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { FormsModule } from '@angular/forms';\nimport { Routes, RouterModule } from '@angular/router';\n\nimport { IonicModule } from '@ionic/angular';\n\nimport { AltaClientePage } from './alta-cliente.page';\n\nconst routes: Routes = [\n  {\n    path: '',\n    component: AltaClientePage\n  }\n];\n\n@NgModule({\n  imports: [\n    CommonModule,\n    FormsModule,\n    IonicModule,\n    RouterModule.forChild(routes)\n  ],\n  declarations: [AltaClientePage]\n})\nexport class AltaClientePageModule {}\n","module.exports = \"<ion-header>\\n  <ion-toolbar color=\\\"primary\\\">\\n    <ion-title>Registro</ion-title>\\n  </ion-toolbar>\\n</ion-header>\\n\\n<ion-content>\\n  <ion-item>\\n    <ion-label position=\\\"floating\\\">Tipo de usuario</ion-label>\\n    <ion-select [(ngModel)]=\\\"this.tipoRegistro\\\">\\n      <ion-select-option>Usuario</ion-select-option>\\n      <ion-select-option>Anónimo</ion-select-option>\\n    </ion-select>\\n  </ion-item>\\n\\n  <ion-item>\\n    <ion-label position=\\\"floating\\\">Nombre</ion-label>\\n    <ion-input type=\\\"text\\\" [(ngModel)]=\\\"this.nombreUsuario\\\"></ion-input>\\n  </ion-item>\\n\\n  <ng-container *ngIf=\\\"this.tipoRegistro == 'Nuevo usuario'\\\">\\n    <ion-item>\\n      <ion-label position=\\\"floating\\\">Apellido</ion-label>\\n      <ion-input type=\\\"text\\\" [(ngModel)]=\\\"this.apellidoUsuario\\\"></ion-input>\\n    </ion-item>\\n  \\n    <ion-item>\\n      <ion-label position=\\\"floating\\\">DNI</ion-label>\\n      <ion-input type=\\\"number\\\" [(ngModel)]=\\\"this.dniUsuario\\\"></ion-input>\\n    </ion-item>\\n  \\n    <ion-item>\\n      <ion-label position=\\\"floating\\\">Correo</ion-label>\\n      <ion-input type=\\\"email\\\" [(ngModel)]=\\\"this.correoUsuario\\\"></ion-input>\\n    </ion-item>\\n  \\n    <ion-item>\\n      <ion-label position=\\\"floating\\\">Clave</ion-label>\\n      <ion-input type=\\\"password\\\" [(ngModel)]=\\\"this.claveUsuario\\\"></ion-input>\\n    </ion-item>\\n  </ng-container>\\n\\n\\n  <ion-item lines=\\\"full\\\">\\n    <ion-label>Imagen: </ion-label>\\n    <ion-label *ngIf=\\\"this.urlFotoUsuario != ''\\\">\\n      <ion-thumbnail>\\n        <ion-img [src]=\\\"this.urlFotoUsuario\\\"></ion-img>\\n      </ion-thumbnail>\\n    </ion-label>\\n    <ion-label *ngIf=\\\"this.urlFotoUsuario == ''\\\">NaN</ion-label>\\n  </ion-item>\\n\\n  <ion-button (click)=\\\"this.tomarDatosDNI()\\\" expand=\\\"full\\\" color=\\\"primary\\\">Datos desde código QR del DNI</ion-button>\\n  <ion-button (click)=\\\"this.tomarFotoUsuario()\\\" expand=\\\"full\\\" color=\\\"warning\\\">Cargar foto</ion-button>\\n  <ng-container *ngIf=\\\"this.tipoRegistro == 'Nuevo usuario'\\\">\\n    <ion-button (click)=\\\"this.cargarUsuario()\\\" expand=\\\"full\\\" color=\\\"success\\\">Registrar usuario</ion-button>\\n  </ng-container>\\n  <ng-container *ngIf=\\\"this.tipoRegistro == 'Anónimo'\\\">\\n    <ion-button (click)=\\\"this.cargarUsuario()\\\" expand=\\\"full\\\" color=\\\"primary\\\">Ingresar como anónimo</ion-button>\\n  </ng-container>\\n</ion-content>\"","module.exports = \"\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IiIsImZpbGUiOiJzcmMvYXBwL3BhZ2luYXMvYWx0YS1jbGllbnRlL2FsdGEtY2xpZW50ZS5wYWdlLnNjc3MifQ== */\"","\nimport { Router } from '@angular/router';\nimport { AuthService } from './../../servicios/auth.service';\nimport { FirestorageService } from './../../servicios/firestorage.service';\nimport { Component } from '@angular/core';\nimport { BarcodeScannerOptions, BarcodeScanResult, BarcodeScanner } from '@ionic-native/barcode-scanner/ngx';\nimport { Camera, CameraOptions } from '@ionic-native/camera/ngx';\n\n@Component({\n  selector: 'app-alta-cliente',\n  templateUrl: './alta-cliente.page.html',\n  styleUrls: ['./alta-cliente.page.scss'],\n})\nexport class AltaClientePage {\n  public nombreUsuario: string;\n  public apellidoUsuario: string;\n  public dniUsuario: string;\n  public correoUsuario: string;\n  public claveUsuario: string;\n  public dataFotoUsuario: string;\n  public urlFotoUsuario: string;\n  public nacionalidadUsuario: string;\n  public nacimientoUsuario: string;\n  public tipoRegistro: string;\n  public dataDNI: string[];\n\n  constructor(private barcodeScanner: BarcodeScanner, private camera: Camera,\n  private authService: AuthService, private firestorageService: FirestorageService, private router: Router) {\n    this.nombreUsuario = '';\n    this.apellidoUsuario = '';\n    this.dniUsuario = '';\n    this.correoUsuario = '';\n    this.claveUsuario = '';\n    this.dataFotoUsuario = '';\n    this.urlFotoUsuario = '';\n    this.nacionalidadUsuario = '';\n    this.nacimientoUsuario = '';\n    this.tipoRegistro = 'Nuevo usuario';\n  }\n\n  public tomarDatosDNI() {\n    const options: BarcodeScannerOptions = { prompt: 'Escanee el DNI', formats: 'PDF_417' };\n    this.barcodeScanner.scan(options).then((resultado: BarcodeScanResult) => {\n      this.dataDNI = (resultado.text).split('@');\n      this.dniUsuario = this.dataDNI[1].trim();\n      this.apellidoUsuario = this.dataDNI[4];\n      this.nombreUsuario = this.dataDNI[5];\n    });\n  }\n\n  public tomarFotoUsuario() {\n    const options: CameraOptions = {\n      quality: 50,\n      targetWidth: 500,\n      targetHeight: 500,\n      destinationType: this.camera.DestinationType.DATA_URL,\n      encodingType: this.camera.EncodingType.JPEG,\n      mediaType: this.camera.MediaType.ALLMEDIA,\n      sourceType: this.camera.PictureSourceType.CAMERA,\n      correctOrientation: true,\n      saveToPhotoAlbum: true\n    };\n\n    this.camera.getPicture(options).then((imageData) => {\n      this.dataFotoUsuario = imageData;\n      this.firestorageService.uploadFotoToFirebase(imageData).then(imageURL => {\n        this.urlFotoUsuario = imageURL;\n      });\n    });\n  }\n\n  public cargarUsuario() {\n    if ((this.tipoRegistro === 'Anónimo' && this.nombreUsuario === '') ||\n    this.tipoRegistro === 'Nuevo usuario' && (this.nombreUsuario === '' || this.apellidoUsuario === '' ||\n    this.dniUsuario === '' || this.correoUsuario === '' || this.claveUsuario === '')) {\n\n      return;\n    }\n\n    if (this.tipoRegistro === 'Nuevo usuario' && this.claveUsuario.length < 6) {\n\n      return;\n    }\n\n    let emailRegex;\n    emailRegex = /^(([^<>()[\\]\\.,;:\\s@\\\"]+(\\.[^<>()[\\]\\.,;:\\s@\\\"]+)*)|(\\\".+\\\"))@(([^<>()[\\]\\.,;:\\s@\\\"]+\\.)+[^<>()[\\]\\.,;:\\s@\\\"]{2,})$/i;\n\n    if (this.tipoRegistro === 'Nuevo usuario' && !emailRegex.test(this.correoUsuario)) {\n\n      return;\n    }\n\n    if (this.urlFotoUsuario === '') {\n\n      return;\n    }\n\n    if (this.tipoRegistro === 'Nuevo usuario') {\n      this.authService.CrearAuth(this.correoUsuario, this.claveUsuario, {\n        uid: '',\n        foto: this.urlFotoUsuario,\n        nombre: this.nombreUsuario,\n        apellido: this.apellidoUsuario,\n        mail: this.correoUsuario,\n        dni: this.dniUsuario,\n        activo: false,\n        perfil: 'cliente'\n      }, this.dataFotoUsuario).then(usuario => {\n\n      }).catch(error => {\n\n      });\n    }\n    else {\n      this.authService.loginAnonimo({\n        foto: this.urlFotoUsuario,\n        nombre: this.nombreUsuario,\n        perfil: 'anonimo'\n      }, this.dataFotoUsuario).then(usuario => {\n        this.router.navigate(['/home-cliente']);\n\n      }).catch(error => {\n\n      });\n    }\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { AngularFireStorage } from '@angular/fire/storage';\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class FirestorageService {\n\n  constructor(private fireStorage: AngularFireStorage) { }\n\n  async uploadFotoToFirebase(dataFoto: string) {\n    const picName = (new Date()).getTime().toString();\n    const respuesta = await this.fireStorage.storage.ref(picName).putString(dataFoto, 'base64', { contentType: 'image/jpeg' }).\n    then((uploadFoto) => {\n      return uploadFoto.ref.getDownloadURL().then(downloadLink => {\n        return downloadLink.toString();\n      });\n    });\n\n    return respuesta;\n  }\n}\n"],"sourceRoot":""}