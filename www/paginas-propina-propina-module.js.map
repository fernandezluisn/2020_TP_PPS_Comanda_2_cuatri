{"version":3,"sources":["webpack:///./src/app/paginas/propina/propina.module.ts","webpack:///./src/app/paginas/propina/propina.page.html","webpack:///./src/app/paginas/propina/propina.page.scss","webpack:///./src/app/paginas/propina/propina.page.ts","webpack:///./src/app/servicios/mesa-cliente.service.ts"],"names":[],"mappings":"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","file":"paginas-propina-propina-module.js","sourcesContent":["import { NgModule } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\nimport { FormsModule } from '@angular/forms';\r\nimport { Routes, RouterModule } from '@angular/router';\r\n\r\nimport { IonicModule } from '@ionic/angular';\r\n\r\nimport { PropinaPage } from './propina.page';\r\n\r\nconst routes: Routes = [\r\n  {\r\n    path: '',\r\n    component: PropinaPage\r\n  }\r\n];\r\n\r\n@NgModule({\r\n  imports: [\r\n    CommonModule,\r\n    FormsModule,\r\n    IonicModule,\r\n    RouterModule.forChild(routes)\r\n  ],\r\n  declarations: [PropinaPage]\r\n})\r\nexport class PropinaPageModule {}\r\n","module.exports = \"<ion-header>\\r\\n  <ion-toolbar>\\r\\n    <ion-title>Propina</ion-title>\\r\\n  </ion-toolbar>\\r\\n</ion-header>\\r\\n\\r\\n<ion-content>\\r\\n  <h2>¿Cuál es su grado de satisfacción con respecto a la atención del mozo?</h2>\\r\\n\\r\\n  <ion-button  color=\\\"dark\\\" size=\\\"small\\\" (click)=\\\"escanear()\\\">Cargar</ion-button>\\r\\n  <h1 *ngIf=\\\"satisfaccion\\\">Usted piensa que la atención ha sido {{satisfaccion}}</h1>\\r\\n\\r\\n  <ion-button  color=\\\"dark\\\" size=\\\"small\\\" (click)=\\\"limpiar()\\\">Limpiar</ion-button>\\r\\n\\r\\n  <ion-button  (click)=\\\"subirPropina()\\\">Confirmar Propina</ion-button>\\r\\n</ion-content>\\r\\n\"","module.exports = \"\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IiIsImZpbGUiOiJzcmMvYXBwL3BhZ2luYXMvcHJvcGluYS9wcm9waW5hLnBhZ2Uuc2NzcyJ9 */\"","import { Component, OnInit } from '@angular/core';\r\nimport { ActivatedRoute,Router } from '@angular/router';\r\nimport { BarcodeScanner } from '@ionic-native/barcode-scanner/ngx';\r\nimport { Vibration } from '@ionic-native/vibration/ngx';\r\nimport { AlertController, LoadingController } from '@ionic/angular';\r\nimport { MesaCliente } from 'src/app/interfaces/mesa-cliente';\r\nimport { MesaClienteService } from 'src/app/servicios/mesa-cliente.service';\r\n\r\n@Component({\r\n  selector: 'app-propina',\r\n  templateUrl: './propina.page.html',\r\n  styleUrls: ['./propina.page.scss'],\r\n})\r\nexport class PropinaPage implements OnInit {\r\n\r\n  loading;\r\n  satisfaccion:string=null;\r\n  mesaCliente:MesaCliente;\r\n  listaMEsas:MesaCliente[];\r\n  idMesaCliente:string;\r\n  propina:number\r\n\r\n  constructor(public alertController: AlertController, private router:Router, private bda:MesaClienteService,\r\n    private loadingCtrl: LoadingController, private barcodeScanner: BarcodeScanner, private vibra:Vibration,\r\n    private tomarId:ActivatedRoute,) {\r\n\r\n      this.idMesaCliente=this.tomarId.snapshot.paramMap.get('idMesaCliente');\r\n\r\n      this.bda.devolverListadoMesas().subscribe(lista=>{\r\n        this.listaMEsas=lista;\r\n        this.listaMEsas.filter(mesa=>{\r\n          if(mesa.id==this.idMesaCliente)\r\n          this.mesaCliente=mesa;\r\n        })\r\n      })\r\n     }\r\n\r\n  ngOnInit() {\r\n  }\r\n\r\n  async presentLoading(message: string) {\r\n    this.loading = await this.loadingCtrl.create({\r\n        message,\r\n        spinner: \"bubbles\",\r\n        duration: 1000\r\n    });\r\n    return this.loading.present();\r\n\r\n    \r\n  }\r\n\r\n  cargar(codigo:string){\r\n    let n=0;\r\n    this.satisfaccion=codigo;\r\n    if(codigo==\"Excelente\") {\r\n      n=1.2;\r\n    }else if(codigo==\"Muy Bien\"){\r\n      n=1.15;\r\n    }else if(codigo==\"Bien\"){\r\n      n=1.1;      \r\n    }else if(codigo==\"Regular\"){\r\n      n=1.05;\r\n    }else if(codigo==\"Malo\"){\r\n      n=1;\r\n    }\r\n\r\n    return n;\r\n  }\r\n\r\n  async alertar(mensaje:string){\r\n    const alert= this.alertController.create({\r\n      cssClass: 'danger-alert-btn',\r\n      header: 'Error',\r\n      subHeader: 'Error en la carga',\r\n      message: mensaje,\r\n      buttons: ['OK']\r\n    });\r\n\r\n    (await alert).present();\r\n  }\r\n\r\n\r\n  escanear(){  \r\n\r\n      \r\n    this.barcodeScanner.scan().then(async barcodeData => {\r\n      if(barcodeData.format==\"QR_CODE\")\r\n      {\r\n       \r\n        this.propina=this.cargar (barcodeData.text);\r\n        \r\n      }else{\r\n        this.alertar(\"El código debe ser QR\");\r\n        this.vibra.vibrate(500);\r\n      }\r\n      \r\n     }).catch(err => {\r\n         this.alertar(\"No se ha podido cargar el código.\");\r\n         this.vibra.vibrate(500);\r\n     });\r\n   \r\n   \r\n     //this.cargarUsu();\r\n  }\r\n\r\n  limpiar(){\r\n    this.satisfaccion=null;\r\n  }\r\n\r\n  subirPropina(){\r\n    try{\r\n      this.presentLoading(\"Cargando propina\");\r\n      this.mesaCliente.propina=this.propina;\r\n      this.bda.actualizarMesa(this.mesaCliente);\r\n      this.router.navigate([\"home-cliente\"]);\r\n    }catch(e){\r\n      this.alertar(e);\r\n    }\r\n    \r\n  }\r\n\r\n}\r\n","import { Injectable } from '@angular/core';\r\nimport { AngularFirestore, DocumentReference } from '@angular/fire/firestore';\r\nimport { Observable } from 'rxjs';\r\nimport { map } from 'rxjs/operators';\r\nimport { MesaCliente } from '../interfaces/mesa-cliente';\r\n\r\n@Injectable({\r\n  providedIn: 'root'\r\n})\r\nexport class MesaClienteService {\r\n\r\n  mesas:Observable<MesaCliente[]>;\r\n\r\n  constructor(private db:AngularFirestore) { \r\n    this.mesas=this.db.collection(\"mesaClientes\").snapshotChanges().pipe(\r\n      map(actions=>{\r\n        return actions.map(\r\n          a=>{\r\n            const data= a.payload.doc.data();\r\n            const id=a.payload.doc.id;\r\n            return {id, ...(data as any)}\r\n          }\r\n        );\r\n      })   \r\n    );\r\n  }\r\n\r\n  createMesaCliente(mesa:MesaCliente): Promise<DocumentReference> {\r\n    return this.db.collection('mesaClientes').add({...mesa});\r\n  }  \r\n\r\n  devolverListadoMesas(){\r\n    return this.mesas;\r\n  }\r\n\r\n  actualizarMesa(mesa:MesaCliente) {     \r\n    \r\n    this.db.doc('mesaClientes' + '/'+mesa.id).update({...mesa});    \r\n    \r\n  }\r\n\r\n  BorrarMesa(mesa: MesaCliente) {\r\n    this.db.doc('mesaClientes/' + mesa.id).delete().then()\r\n  }\r\n}\r\n"],"sourceRoot":""}